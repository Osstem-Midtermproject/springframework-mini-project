<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.webapp.dao.ProgressDao">
	
	<select id="selectByPager" parameterType="pager"  resultMap="selectProgressWithHospitalResultMap">
		select rnum, hname, pdate, pcontent, hpn, pcategory, pdln, paddress, hdln, hdirector, hod, hemail
		    from (
		        select ROWNUM as rnum, hname, pdate, pcontent, hpn, pcategory, pdln, paddress, hdln, hdirector, hod, hemail
		        from (
		            SELECT hname, pdate, pcontent, hpn, pcategory, pdln, paddress, hdln, hdirector, hod, hemail 
		            FROM hospital, progress
		            where hospital.hdln = progress.pdln and hospital.haddress = progress.paddress
		        )
		    where rownum &lt;= #{endRowNo}
		    )
		where rnum &gt;= #{startRowNo}
		
	</select>
	
	<select id="count" resultType="int">
		select count(*)
		from progress, hospital
		where hospital.hdln = progress.pdln and hospital.haddress = progress.paddress
	</select>
	
	<resultMap id="selectProgressWithHospitalResultMap" type="progress">
		<result column="rnum" property="pno" />
		<result column="pdate" property="pdate" />
		<result column="pcontent" property="pcontent" />
		<result column="pcategory" property="pcategory" />
		<result column="pdln" property="pdln" />
		<result column="paddress" property="paddress" />
		<association property="hospital" javaType="hospital">
			<result column="hname" property="hname" />
			<result column="hpn" property="hpn" />
			<result column="hdln" property="hdln" />
			<result column="hdirector" property="hdirector" />
			<result column="hod" property="hod" />
			<result column="hemail" property="hemail" />
		</association>
	</resultMap>
	
	
	<select id="selectByPdln" parameterType="string" resultMap="selectProgressWithHospitalResultMap">
		select *
		from progress, hospital
		where hospital.hdln = progress.pdln and hospital.haddress = progress.paddress and progress.pdln=#{pdln}
	</select>
	
	


</mapper>